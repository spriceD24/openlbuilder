<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OpenL Table Wizard</title>
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/>
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
</head>

<body class="ms-font-m ms-Fabric">
    <div class="wizard-container">
        <!-- Step 1 -->
        <div id="step1" class="step active">
            <h2>Select Table Type</h2>
            <div class="input-group">
                <label for="tableType">Table Type</label>
                <select id="tableType" required>
                    <option value="">Select a type...</option>
                    <option value="datatype">Datatype Table</option>
                    <option value="spreadsheet">Spreadsheet Table</option>
                    <option value="rules">Rules Table</option>
                    <option value="lookup">Lookup Table</option>
                </select>
            </div>
            <div class="button-group">
                <button class="button primary-button" onclick="nextStep(1)">Next</button>
            </div>
        </div>

        <!-- Step 2 -->
        <div id="step2" class="step">
            <h2>Table Details</h2>
            <div class="input-group">
                <label for="tableName">Table Name</label>
                <input type="text" id="tableName" required>
                <label for="rowCount">Number of Rows</label>
                <input type="number" id="rowCount" min="1" value="1" required>
            </div>

            <div id="parametersSection" style="display: none;">
                <h3>Parameters</h3>
                <div id="parameters">
                    <!-- Parameters will be added dynamically -->
                </div>
                <button class="add-parameter-btn" onclick="addParameter()">+</button>
            </div>

            <div id="returnTypeSection">
                <h3>Return Type</h3>
                <!-- Add return type content here if needed -->
            </div>

            <div class="button-group">
                <button class="button secondary-button" onclick="previousStep(2)">Back</button>
                <button class="button primary-button" onclick="createTable()">Create Table</button>
            </div>
        </div>

        <!-- Success Step (as a separate step) -->
        <div id="successPage" class="step">
            <div class="success-page">
                <h2>Success!</h2>
                <p>Table has been created successfully.</p>
                <button class="button primary-button" onclick="backToMenu()">Back to Menu</button>
            </div>
        </div>
    </div>

    <!-- Message containers -->
    <div id="successMessage" style="display: none;">Table created successfully!</div>
    <div id="errorMessage" style="display: none;"></div>

    <script src="taskpane.js" type="text/javascript"></script>
</body>
</html>